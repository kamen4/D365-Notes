#D365_CV #D365 
- [[#Create a survey project with Dynamics 365 Customer Voice|Create a survey project with Dynamics 365 Customer Voice]]
	- [[#Create a survey project with Dynamics 365 Customer Voice#Customer Voice|Customer Voice]]
	- [[#Create a survey project with Dynamics 365 Customer Voice#Projects in Customer Voice|Projects in Customer Voice]]
	- [[#Create a survey project with Dynamics 365 Customer Voice#Create your first project|Create your first project]]
- [[#Create customer surveys with Customer Voice|Create customer surveys with Customer Voice]]
	- [[#Create customer surveys with Customer Voice#Introduction|Introduction]]
	- [[#Create customer surveys with Customer Voice#Survey headers and branding|Survey headers and branding]]
	- [[#Create customer surveys with Customer Voice#Add branching logic to surveys|Add branching logic to surveys]]
	- [[#Create customer surveys with Customer Voice#Personalize a survey with variables|Personalize a survey with variables]]
	- [[#Create customer surveys with Customer Voice#Add satisfaction metrics to a survey and project|Add satisfaction metrics to a survey and project]]
	- [[#Create customer surveys with Customer Voice#Add multiple languages for your surveys|Add multiple languages for your surveys]]
- [[#Send Customer Voice surveys|Send Customer Voice surveys]]
	- [[#Send Customer Voice surveys#Introduction|Introduction]]
	- [[#Send Customer Voice surveys#Create and personalize email templates|Create and personalize email templates]]
	- [[#Send Customer Voice surveys#Translate email templates into other languages|Translate email templates into other languages]]
	- [[#Send Customer Voice surveys#Email a survey|Email a survey]]
	- [[#Send Customer Voice surveys#Upload CSV files|Upload CSV files]]
	- [[#Send Customer Voice surveys#Use links and QR codes|Use links and QR codes]]
	- [[#Send Customer Voice surveys#Analyze survey reports|Analyze survey reports]]
		- [[#Analyze survey reports#Survey distribution overview|Survey distribution overview]]
		- [[#Analyze survey reports#Survey response report|Survey response report]]
		- [[#Analyze survey reports#Satisfaction metrics|Satisfaction metrics]]
		- [[#Analyze survey reports#Alerts|Alerts]]
- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate|Automate Dynamics 365 Customer Voice surveys with Power Automate]]
	- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate#Send a survey with Power Automate|Send a survey with Power Automate]]
	- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate#Create an invitation|Create an invitation]]
	- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate#Expand variables to further customize surveys|Expand variables to further customize surveys]]
	- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate#Use the locale variable for multilingual surveys|Use the locale variable for multilingual surveys]]
	- [[#Automate Dynamics 365 Customer Voice surveys with Power Automate#Use variables for follow-up actions|Use variables for follow-up actions]]
- [[#Embed surveys in your website with Dynamics 365 Customer Voice|Embed surveys in your website with Dynamics 365 Customer Voice]]
	- [[#Embed surveys in your website with Dynamics 365 Customer Voice#Embed a survey in your website|Embed a survey in your website]]
	- [[#Embed surveys in your website with Dynamics 365 Customer Voice#Use context data from the survey responses|Use context data from the survey responses]]
- [[#Create customer Power BI reports in Customer Voice|Create customer Power BI reports in Customer Voice]]
	- [[#Create customer Power BI reports in Customer Voice#Use the Dynamics 365 Customer Voice Power BI template|Use the Dynamics 365 Customer Voice Power BI template]]
	- [[#Create customer Power BI reports in Customer Voice#Connect to Dynamics 365 Customer Voice data with Power BI|Connect to Dynamics 365 Customer Voice data with Power BI]]
	- [[#Create customer Power BI reports in Customer Voice#Create customized Power BI reports|Create customized Power BI reports]]
	- [[#Create customer Power BI reports in Customer Voice#Calculate the Net Promoter Score for Customer Voice data|Calculate the Net Promoter Score for Customer Voice data]]

## Create a survey project with Dynamics 365 Customer Voice
[(More)](https://learn.microsoft.com/en-us/training/modules/work-customer-voice-projects/)
### Customer Voice
Dynamics 365 Customer Voice uses the ==concept== of projects to divide and contain groups of surveys and reports. A project could contain one or many surveys to be used for different events or _moments of truth_ throughout the customer relationship journey.

The surveys can contain several ==types of questions==: choice, date, Likert, ranking, rating, text, and Net Promoter Score (NPS). NPS is a metric that is used to analyze the overall loyalty of customers. It measures a customer's perception of an organization, product, or service by asking how likely it is that they would recommend to friends or colleagues.

### Projects in Customer Voice
The two main elements of a Dynamics 365 Customer Voice project are:
- Surveys: A project can contain one or many surveys.
- Reports
    - The reports section contains satisfaction metrics that cover all surveys within that project.
    - A response overview report will be created for each survey that is added to the project.

### Create your first project
|Project Template|Template Purpose|
|---|---|
|Periodic Customer Feedback|For regular feedback and relationship maintenance|
|Customer Visit Feedback|For feedback on Dynamics 365 Field Service delivery|
|Customer Feedback|For feedback on Dynamics 365 Sales delivery|
|Customer Service Feedback|For feedback on Dynamics 365 Customer Service|
|Blank|Start from the beginning and create a new survey|
## Create customer surveys with Customer Voice
[(More)](https://learn.microsoft.com/en-us/training/modules/create-customer-voice-surveys/)
### Introduction
|Question type|Description|
|---|---|
|Choice|Add options, allow multiple answers to be selected, and display as a dropdown list, if necessary.|
|Text|Question can capture a short or long answer and be flagged to capture overall sentiment for the survey. Restrictions can be applied to enforce a number, email address, or if a custom regular expression is entered.|
|Rating|Ratings can be captured by using numbers or stars from 1 to 10 or smiley faces from 2 to 5 on the scale.|
|Date|The **Date** column is captured in dd/mm/yyyy or mm/dd/yyyy format based on the default location of the Dynamics 365 Customer Voice environment. The format can't be modified.|
|Ranking|Options are added to the question, and respondents will rank the options in a specific order based on the phrasing of the question. For example: Rank the following options in order of preference to your organization.|
|Likert|The Likert scale is like a matrix. A series of statements is provided, and the respondent must select one of the options that best suits or meets the statement.|
|NPS|The Net Promoter Score is a rating on a scale of zero to 10, asking the respondent if they would recommend a product, service, or organization to a friend or colleague.|
|File upload|A new folder is created in the user's OneDrive for Business account. Responders will be able to upload their files to that folder. This option is not available when the survey is shared externally and the **Only people in my organization can respond** setting is turned off.|
> [!info] 
> A **survey** can have up to **100** questions.
> Likert, choice, and ranking questions, along with their options/statements, **count** toward the overall 100-question limit.
> Therefore, if you include a Likert question with 10 statements, it will reduce the number of remaining questions to 90.
### Survey headers and branding
Dynamics 365 Customer Voice offers several ways that you can customize a survey to fit in with a set of brand guidelines. You can achieve this ==customization== by using the following ==elements==:
- Survey background image
- Survey color
- Custom survey header
- Font style, color, and size
- Customized thank you message and footer text

The quickest way to transform a survey and add some branding is to adjust the branding from the **Customization** menu.
> [!tip]
> Additionally, you can upload an **image** from the branding menu to be used as the background for the survey. **Uploading an image might change the brand color** that was previously selected and might adjust it to a more complimentary color. Then, you can adjust the color again if you want. Though the image will be displayed from a desktop, it won't show when you’re reviewing on a mobile device.

The ==menu controls== that display are as follows:
- **Style** - Selecting this option opens a side panel that provides style options. These options range from professional or friendly to playful or relaxed. Users can select the style that is most fitting for the purpose of the survey and the target audience.
- **Theme color** - This option shows the same color palette and options that are available when users are accessing from the theme color in the branding area.
- **Image** - The survey maker can select from a series of provided images or upload their own image to be used in the survey header.
- **Focal point** - If an image has been uploaded, the focal point option provides the ability to drag the image around to set it in the best place for optimum visibility.
- **Logo** - Selecting this option opens file explorer on the survey maker’s workstation, where they can browse and find a logo file for their organization. After they’ve added the logo, the survey maker can hover the mouse cursor over the logo to display another menu to determine the placement of the logo within the survey header.
- **Undo** - This option provides a quick way to undo the last changes that were made.

By default, when a respondent submits their response to a survey, the displayed ==thank you message== states, _Thank you for sharing your feedback._ You can modify this text and adjust it to show something different. Additionally, you can include hyperlinks and display modified font by using the methods previously indicated. You can add multiple thank you messages and then use logic to determine when the message is shown.

### Add branching logic to surveys
![[4. Surveys with Customer Voice-20240831152102214.webp]]

>You can use display logic to show the question if the response to the Net Promotor Score question is less than a **7**. You can accomplish this task by using the skip logic and going to another question or to the end of the survey if the response is greater than a **6**. Both approaches would provide the same outcome. Furthermore, you can add multiple conditions to the question, and you can include skip and display logic.

![[4. Surveys with Customer Voice-20240831152107486.webp]]

You can access the ==**Advanced logic**== option in the **Customization** menu. If simple logic has already been applied, it will be imported and contained in the **Advanced logic** area. Future changes that you make to the logic (that was originally added as simple logic) will need to be completed from this area. To create advanced logic, you need to give the rule a name. Use a logical name that would make sense to any person who might need to collaborate on the survey. Make sure that the name isn't vague; give it clear, concise, and descriptive keywords.
![[4. Surveys with Customer Voice-20240831152409423.webp]]![[4. Surveys with Customer Voice-20240831152416620.webp]]

The following table describes other options for branching rule actions.

|Type|Details|Usage|
|---|---|---|
|Action|Show|Used only with a question.|
|Action|Hide|Used only with a question.|
|Action|Navigate to|Used with multiple target options.|
|Target|Question|Can be shown or hidden, or it can be used to navigate to a specific question based on a response that was provided to a question that was specified in the condition.|
|Target|Section|Can be shown or hidden, or it can be used to navigate to a specific section based on a response that was provided to a question that was specified in the condition.|
|Target|End of survey|Directs the respondent to the end of the survey, hiding all other questions based on a response that was provided to a question that was specified in the condition.|
|Target|Chained survey|When selected, all other surveys in an environment will be displayed as a list of values. The respondent can be directed to the chained survey on submission of the survey with the branching rule.|
|Target|URL|A URL can be provided to the user as a redirect on completion of a survey. Then, the respondent will be taken to the URL after they have selected the submission button on the survey with the branching rule.|
### Personalize a survey with variables
Variables are comprised of unique data that is linked to the respondent in some way. The simplest variables would be information such as the respondent's first name or last name. You can only use variables when a survey is sent directly to a specified person, not when a link is being shared on social media or on a website where any unknown person can complete the survey. Variables that are used on the survey are passed into the survey invitation in a unique link. Then, they are returned through the related survey response and linked together. ==You can store up to 15 variables on a survey.==

You can use variables in the following scenarios:
- Email invitations within templates
- Survey subtitles
- Survey questions
- Embedding surveys into websites
- Hidden variables to use for reporting and analysis

You can ==add more variables== by using the **Add variable** option. Make sure that you give the variable a name and a default value.

You can use the added variables in different places to pull in data from your data source. If the intent is not to use Power Automate, the only variables that you can use successfully are **First Name** and **Last Name**.

To personalize an ==email template==, select from the list of variables. These variables are then passed through when you send a survey invitation email. While you can use all your variables, keep the previous logic in mind where, if variables other than **First Name** and **Last Name** are to be used, Power Automate must also be used.

### Add satisfaction metrics to a survey and project
Satisfaction metrics exist on three different levels:
- **Survey response** - Each individual survey response holds the satisfaction metrics for that specific respondent.
- **Survey** - Each survey has satisfaction metrics added to it. You can review these overall metrics from the **Satisfaction metrics** report by adding a filter and switching from one survey to another.
- **Project** - The default **Satisfaction metrics** report will show the results for all survey responses for all surveys within the project.

|Metric type|Details|
|---|---|
|NPS|Add a Net Promoter Score (NPS) question to a survey to track the overall satisfaction of a respondent by using a scale from zero to 10. A person who responds with a 0 to 6 is known as a Detractor, someone who responds with a 7 or an 8 is Passive, and a respondent with a 9 or 10 is a Promoter.|
|Sentiment|Sentiment is calculated based on the sentiment of a response that is provided to a text-based question. This metric is based on analysis of the words that are used and will end in a result of either Positive, Negative, or Neutral.|
|CSAT|Customer Satisfaction (CSAT) is an indicator of how satisfied a customer is based on a response that they have given to a ratings question. This metric could indicate a customer's satisfaction level with a product, service, or experience.|
As survey responses are received, you can review the satisfaction metrics from the **Reports** area on a project. By default, all surveys are shown, but you can filter this view by switching from one survey to another in the dropdown menu. Satisfaction metrics will also be displayed on the home page dashboard in Dynamics 365 Customer Voice. The satisfaction metrics for a specific response are stored in a **Satisfaction metric** value within the related Microsoft Dataverse environment.

### Add multiple languages for your surveys
>After a survey has been created, you can add more languages as necessary. Adding languages is a straightforward process, with over 40 languages available out of the box. Moreover, you can add custom languages by defining the display name code that should be used. You can add up to 86 languages to a survey. You can access the **Languages** menu from the **Customization** menu on the right side of a survey. Search for and select the required language, and then select **Add language** so that the survey will include it in the list of languages.

Respondents can use several different ways to view the survey in a specific language:
- They can use Power Automate to set the locale value (_de_ for German or _fr-FR_ for French) through a flow. When you send a survey invitation, the survey will create the correct link to make sure that the right language is displayed.
- They can create custom survey links to pass the language value through by appending **&lang=** with the code for the language to the end of the survey URL. This method will force that language to be displayed automatically.
- If a respondent’s browser language setting matches one of the languages on the survey, the translated version will display automatically.
- If the setting to allow respondents to change languages is turned on, they can use the language control from the top of the survey to select their preferred language in which to view and complete the survey.

## Send Customer Voice surveys
[(More)](https://learn.microsoft.com/en-us/training/modules/send-customer-voice-surveys/)
### Introduction
>An email template consists of several components, some of which are required. Other components might improve the overall appearance and help make the email clear and concise. Consider the following elements when you're creating email templates.

| Component        | Required | Details                                                                                                                                                                                                                                                                                                                                  |
| ---------------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Subject          | Yes      | The survey invitation must have a subject; it's required on any email template that is created. As with any type of email, survey invitations with a subject are more likely to be responded to.                                                                                                                                         |
| Survey link      | Yes      | A link to the survey is required. This link can be in the form of a direct link, or it can be with an image and by using [ [SurveyLink]] in the URL link. When the email invitation is sent, a personalized link is generated for each survey recipient to allow tracking of the survey responses that are received.                     |
| Unsubscribe link | Yes      | The unsubscribe link must be included in the email template. This link allows the recipient of the email to unsubscribe from receiving more requests to take surveys that are sent from Dynamics 365 Customer Voice (based on the environment that they're sent from).                                                                   |
| Variables        | No       | Variables can be used to show personalized information such as first name or last name. You can use these variables when you're sending directly from Dynamics 365 Customer Voice. Other variables must be used in conjunction with a flow in Microsoft Power Automate to pull information, such as company name, case title, and so on. |
| Logo             | No       | If an image has been added to the survey, it will be added to the top of the survey template by default. You can remove it if it's not required, but it can help with brand recognition.                                                                                                                                                 |
| Images           | No       | Images can be added to other areas of the email template and used in social media profile links, headers, or further brand recognition.                                                                                                                                                                                                  |
### Create and personalize email templates
You can access the ==email templates== from a survey in Customer Voice by selecting the **Send** tab and then selecting the **Email** option. Every project, regardless of whether a project template was used or if it was created from blank, will include at least one email template. Email templates for a project that are created from blank will include a generic subject and basic styling in the body of the email. Project templates might have a slightly customized subject and a more aesthetically pleasing layout in the body of the email.

You can ==modify the email== body by using the WYSIWYG editing controls. You can edit and highlight text to change the font style and size, make it bold, italic, or underlined, and change the font color and background color. Additionally, you can add tables and images to assist in creating a well-formatted, brand-aware template.

The ==**Personalized variables**== option from the **Insert** menu can help you provide further recognition for the email recipient. Adding content can help the recipient recognize why they're being asked for feedback, and it can also encourage them to respond with feedback. After adding variables in the **Personalization** menu, you can insert them directly into the email subject or the email body.

### Translate email templates into other languages
In a survey that includes more than one language, you can select the **Language** dropdown menu on an email template to automatically show the default language for the survey. When the survey was created, if subsequent languages were added, the first email template (and others that were created) was assigned to the original language. To make sure that you can use an email template that accommodates each new language, you need to create the various versions of the template. After you select the **Language** menu, select the **Choose language** option. This option is only active if a language still needs to be translated for the template that you're viewing.

When using ==Power Automate to send survey invitations==, you can set the **locale** field on the send survey or create invitation action to a specific language to automate the experience. However, you need to make sure that the communication is sent in the preferred language. Consider using a field on the related contact rows to make sure that the selected language is relevant to the respondent.

### Email a survey
Go to ==Outlook== or Dynamics 365, and in the search box on the Contacts tab, enter the name of a person or an email address to display a list of suggested people who meet the value that you entered. When the required contact displays, select their name to add the contact into the **To** column. You can add multiple recipients, and each person will receive their own individual email, without indication of whom else the email was sent to.

Another option for Dynamics 365 customers is to search for and send a survey invitation to all contacts who are returned from a ==view==. Views are created as system or personal views, both of which you can select for sending. By typing the name of the view in the **To** column, a list of views that match the criteria will display. Then, you can send the email with a copy going to each person who meets the search criteria of the view that was selected.

![[4. Surveys with Customer Voice-20240831163258827.webp]]

The possible survey invitation status values are shown in the following table.

|Status|Meaning|
|---|---|
|In progress|The survey invitation email is queued to be sent.|
|Sent|The survey invitation email has been successfully delivered to the recipient.|
|Read|The survey invitation email has been read or opened.|
|Started|The survey has been started by the recipient but is not yet complete.|
|Responded|The recipient has responded to the survey.|
|Failed|The survey invitation email wasn’t delivered to the recipient due to an incorrect email address or other error.|
|Unsubscribed|The recipient has unsubscribed from receiving the survey-related emails.|
### Upload CSV files
>The first step that the marketing team should take is to determine if these attendees should be added to the Microsoft Dataverse environment as contact records. By default, on each survey, a setting determines that all unknown email addresses that are sent a survey invitation will be created as a new contact record. If the email address is found as a match, the survey invitation record will be linked to that contact. This approach might not be appropriate for all circumstances, so you can turn off this function on a survey-by-survey basis. You can access the setting for **Add respondents as Contacts** from the **Send** tab and then the **Customization** menu. Select **Distribution settings > Respondent settings**, which will provide the switch to turn on or off this function, depending on the requirements for the survey.

The spreadsheet must be a CSV file and must meet the following criteria:
- The CSV file should contain the following comma-separated values for each contact in the sequence:
    - Email address (mandatory)
    - First Name
    - Last Name
- The first row in the file is assumed to be the header and it will not be imported.
- Only 10,000 recipients can be imported at once. If more than 10,000 recipients exist, split them into multiple CSV files before importing them.

In addition, you can associate a survey invitation and response to a table in the same Dataverse environment by adding the following columns and information to the CSV file:
- **RegardingID** - ID of the table to associate with the survey invitation and response.
- **RegardingtableName** - Name of the table to associate with the survey invitation and response.

>When the format is correct, the marketing team can import the information by going to the **Send** tab for a survey and then selecting **Email**. The **Upload contacts** option is located next to the **To** column. After browsing for the file of records from the event, a team member can select and import the file.
>![[4. Surveys with Customer Voice-20240831163806421.webp]]

### Use links and QR codes
The **Anonymous responses** toggle switch determines which variables will be saved along with the survey response. This feature is helpful if the survey feedback must be anonymous but variables such as language, country/region, or department need to be saved to assist with reporting on the responses.

In the **Send** area of the survey, you can review all ways to distribute the survey. Using the **Link** option provides the full URL to the survey, which you can copy and share on social media or within an email. The provided link is automatically shortened, making it more usable in multiple social media platforms or text services. Select the **Create link** option, which will direct you to a screen with all variables that exist for the survey. After you've selected variables, you'll need to add values for each. You can set up multiple links at once by selecting the **Add more values** option.

You can access the main survey QR code from the **Send** overview tab or from the link area. QR codes are provided as an image that the survey maker can download in Customer Voice. The QR code is _snapped_, similar to taking a photograph with a phone or tablet device.

### Analyze survey reports
The four main areas to review reports or analytics are:
- Survey distribution overview
- Survey response report
- Satisfaction metrics
- Alerts
#### Survey distribution overview
![[4. Surveys with Customer Voice-20240831164449386.webp|486]]
![[4. Surveys with Customer Voice-20240831164458080.webp]]
- **Total invites** - Displays the total number of survey invitations that were sent.
- **Responded** - Displays the total number of recipients who responded to the survey invitations.
- **Not responded** - Displays the total number of recipients who haven't responded to the survey invitations. A pie chart shows the distribution of survey invitations by status:
    - **Unread** - The survey invitation email wasn't read.
    - **Read** - The survey invitation email was read or opened.
    - **Opened** - The survey was opened but hasn't been completed yet.
- **Unsubscribed** - Displays the total number of recipients who have unsubscribed from receiving survey-related emails.
- **Failed** - Displays the total number of survey invitations that weren't delivered to recipients due to an incorrect email address or other error.

#### Survey response report
Additionally, you can export the responses to a Microsoft Excel workbook for further analysis. Selecting the **Respondents** menu on the report will display a list of all responses that have been received. Double-clicking one of the responses from the list will open details in a pop-up window. This feature allows you to scroll through the provided answers. You'll also be able to review the personalized data, which will contain the variables that were collected through the invitation and then stored against the survey response. If needed, you can delete survey responses from the individual records.
![[4. Surveys with Customer Voice-20240831164635013.webp]]

#### Satisfaction metrics
You can set up satisfaction metrics in four different ways, which results in four different possible charts that can display on the report.
- **Net Promoter Score (NPS)** - A meter chart that shows the score for the metric. The area chart toward the right of the meter chart shows the trend of Net Promoter Score for the selected time period.
- **Sentiment** - A pie chart that shows the distribution of positive, neutral, and negative sentiments for the metric. The stacked column chart toward the right of the pie chart shows the distribution of positive, neutral, and negative sentiment for the selected time period.
- **CSAT** - A meter chart that shows the score for the metric. The area chart toward the right of the meter chart shows the trend of CSAT scores for the selected time period.
- **Custom score** - A meter chart that shows the score for the metric. The area chart toward the right of the meter chart shows the trend of custom scores for the selected time period.

Select the **View satisfaction metrics** option in the upper-left corner of the report to review satisfaction metrics. However, you need to add new metrics directly from a survey from the **Customization** menu on the **Design** tab.
![[4. Surveys with Customer Voice-20240831164751020.webp]]

#### Alerts
Another area in the **Reports** section is **Alerts**. By adding alerts, you can create triggers to indicate a specific way that a question was responded to. For example, creating an alert when a Net Promoter Score is responded to with a 6 or below indicates a Detractor.
![[4. Surveys with Customer Voice-20240831164834590.webp]]


## Automate Dynamics 365 Customer Voice surveys with Power Automate
[(More)](https://learn.microsoft.com/en-us/training/modules/automate-customer-voice-surveys/)
### Send a survey with Power Automate
==Adding a variable to a survey element== is simple, and you can access variables from the **Variables** drop-down list, as shown in the following image. They can be added to the survey description, into the question text, and into the question subtitle.

After the **First Name** variable has been added to the survey, it is now time to ==set up the flow in Power Automate==. Selecting the **Send** tab at the top of a survey will show all methods that you can use to distribute the survey, including the option to configure a flow by using Power Automate

For Contoso’s requirement, the **Send a survey when a case is resolved in Dynamics 365** template is the best option. After the flow has been configured, you can ==access it== by returning to the **Home** area and then selecting the number that shows a flow that is configured. Additionally, you can ==review all flows== that are linked to a survey and see the name of the flow, the email template that was used, how many times the flow has run, how many times it has failed, and if the flow is currently turned on or off. To ==make modifications== to the flow, select the pencil edit icon next to the flow.

Use the **Recipient details** column to associate the activity (and any related survey response) to the appropriate contact record that the survey invitation will be sent to. The activity will be displayed in the recipients record timeline in the related Dataverse environment.

Using the template means that the **First Name** and **Last Name** variables are automatically populated in the **Send a survey** action step in the flow. However, you can add these variables if you are creating a new flow or adjusting a flow. You can complete this action by adding the first name dynamic value from the related contact that is linked on the case.
![[4. Surveys with Customer Voice-20240831170215856.webp]]

### Create an invitation
Another Dynamics 365 Customer Voice connector action is also available for you to use: the **Create an invitation** action. Creating an invitation still creates the survey invitation activity record, similar to the process with the **Send a survey** action. However, using the **Create an invitation** action creates a personalized link that is accessible throughout the rest of the flow.

In this example, the **Send a survey when an order is fulfilled in Dynamics 365** template is selected. You can delete the **Send a survey** step and search for and add the **Create an invitation** action instead. Similar to the **Send a survey** step, you can use dynamic values to populate the email, first name, and last name variables. The **Regarding** column is linked to the sales order, and the **Recipient details** column is linked to the contact that will receive the survey invitation.
![[4. Surveys with Customer Voice-20240831170441668.webp|577]]

The invitation link should be added as well. Using the direct link will result in a long string appearing in the email. Instead, you can create a shortened link by using simple HTML tags. Select the HTML **</>** button to show the HTML view, and then add the following logic:
```html
<a href="[InvitationLink]">Complete Our Survey</a>
```
When the email is generated and sent out, the respondent will see **Complete Our Survey** underlined as a hyperlink. Selecting this link will take them to the survey to complete. After the survey has been completed, the survey response will be linked to the records that are added in the **Regarding** and **Recipient details** columns that are set in the flow in Power Automate.

### Expand variables to further customize surveys
Select the **Customization** menu to the right of the survey and then select **Variables**. You can add up to 15 variables, including **First Name**, **Last Name**, and **locale**. In this example, two new variables called **Case Number** and **Case Title** will be added. The variable name can only include letters and numbers, without spaces in between.
![[4. Surveys with Customer Voice-20240831170830435.webp]]
Until the variables are defined in Power Automate, if the survey link is shared in some way, the survey will show {{CaseNumber}} and {{CaseTitle}} rather than the actual values from the case that was closed. To fit everything together, you need to define the new variables for any flow that is used to send a survey or create an invitation. When the correct column is found, you can select to add it to the variable in the Dynamics 365 Customer Voice action step in the flow. Next, you can add the **Case Title** variable. Now, when the flow is triggered, the **Case Number** and **Case Title** variables will be populated with the correct values from the case that was closed.
![[4. Surveys with Customer Voice-20240831170923683.webp]]

### Use the locale variable for multilingual surveys
The variable is one of three defaults that are added each time a new survey is created, and it can be deleted if it's not required. To use it, make sure that the variable is still in place, and if not, it can be added again with the variable name of **locale**.

You can use several approaches when structuring a flow in Power Automate, but in this example of using the locale variable, assume that a case has been closed, which will trigger the flow to run. It's important that a **Get record** action step from the Microsoft Dataverse connector is used to get the contact that is related to the case. Next, a **Compose** action step is required so that the locale can be translated from the language on the contact record.
![[4. Surveys with Customer Voice-20240831171518924.webp]]
An **if** statement is needed for each language that a contact could possibly have from the choice column. After the value, the correct language code needs to be used. To be sure that the correct code is used, download the Excel translations file from the **Languages** section on the survey in Dynamics 365 Customer Voice; the code for additional languages is at the top of each column.
```js
if(equals(outputs('Get_Contact')?['body/custom_column'],916780000),'fr', if(equals(outputs('Get_Contact')?['body/custom_column’],916780001),'de',
'en-gb')))
```
The **Compose** step has an output, which is one of the locale codes that are set in the expression. The **Outputs** parameter is then added to the **locale** column from the dynamic content area and included in either a **Create an invitation** step or a **Send a survey** step in the flow. After the flow has been triggered, and a recipient is sent a link to the survey by email or some other mechanism, selecting the link will take them to the survey that is displayed in their preferred language.
![[4. Surveys with Customer Voice-20240831171756784.webp]]

### Use variables for follow-up actions
![[4. Surveys with Customer Voice-20240831172033982.webp]]
By using an expression similar to the one in the following example, you can update the **Trigger Conditions** section so that the flow only runs if the response is for a survey with a specific ID.
```js
@equals(triggerBody()?['_msfp_surveyid_value'], 'SURVEY ID')
```
![[4. Surveys with Customer Voice-20240831172144412.webp|452]]

After the trigger condition is met, the flow will continue to run and go to the next step. The first action that is needed in the flow is to get the survey response details. By using the Microsoft Forms connector, you can use the **Get response details** action to get the details. For the response ID, the following expression is required to parse the source response identifier value from a string into an integer value.
```c
int(triggerBody()?['msfp_sourceresponseidentifier'])
```

The **Survey Response** form can be customized to clearly show the **Context Data** column. Users can then see the variable name, followed by the value that was passed through in the survey invitation. The following example shows that the **First Name** is Jane and the **Last Name** is Doe. The information in the **Context Data** area can be copied and pasted for use in the flow.
![[4. Surveys with Customer Voice-20240831172335513.webp]]

> [!tip]
> For organizations without a Power Apps license, accessing the context data is still possible through Power Automate as part of the same flow. Search for and add a **Compose** step directly after the **Get response details** step. Then, on the **Dynamic content** tab, search for the **Context Data** column from the initial trigger step and add that column into the inputs for the **Compose** step. This part is only needed once so that the **Context Data** column can be accessed and used in the next steps of the flow. If the survey is completed as a test, the flow will run and ideally will be successful. By selecting the successful run to view the flow, the **Compose** step should include the context data JSON file in the output.

From this point on, it shouldn't matter if an organization has a Power Apps license or not. Continue to edit the flow and add a **Parse JSON** step. Add the context data to the content value, and then select **Generate from sample** at the bottom of the action step. Paste in the context data values that were copied either from the **Compose** step (in the situation without access to Power Apps) or from a survey response record in a Power Apps model-driven app (with access to Power Apps).
![[4. Surveys with Customer Voice-20240831172439838.webp]]

## Embed surveys in your website with Dynamics 365 Customer Voice
[(More)](https://learn.microsoft.com/en-us/training/modules/embed-surveys/)
### Embed a survey in your website
Many methods exist for sending a survey, but the embed option provides a way to display the Dynamics 365 Customer Voice form directly on a webpage. You can access the **Embed** option from the **Send** tab on a specific survey. It is important to understand that any provided embed code is unique to the survey that is currently being reviewed.
![[Pasted image 20240831174152.png|528]]
The **Embedding** page for a survey contains three different formats that you can use.

|Embed style|Details|
|---|---|
|Inline|This style is similar to using an iframe in that the survey is embedded directly within a webpage, showing it statically. The survey can be placed anywhere on the page by using the inline code.|
|Pop-up|A pop-up window can be used to show the survey in the middle of a page, overlaying across the webpage beneath it.|
|Button|When you use the code for the button, it is displayed on the lower-right corner of a webpage and, when selected, expands to display the survey for the website visitor.|
After you have selected the embed format, when the code is displayed, selecting the **Copy** button will add it to the user’s clipboard, providing the ability to then paste it into Notepad (or any code editor) to review.
The code will be similar to the following sample:
```html
<script
	src="https://mfpembedcdntip.azureedge.net/mfpembedconttip/Embed.js" type="text/javascript"></script>

<link
	rel="stylesheet"
	type="text/css" href="https://mfpembedcdntip.azureedge.net/mfpembedconttip/Embed.css" />

<script type = "text/javascript" >
function renderSurvey(parentElementId,FirstName, LastName, ProductPage)
{ 
	var se = newSurveyEmbed(     "UMck_jU0zkqaWu5hQY9ZJfSe99ccZGtMuDUB_NkyHxRUQjJNU1dMNEc1ODVWOFdTRTMwNlowQTVPMS4u",
	"https://forms.office.com/",	  "https://mfpembedcdntip.azureedge.net/mfpembedconttip/",
	"true");
	 var context = {
		 "First Name": FirstName,
		 "Last Name": LastName,
		 "ProductPage": ProductPage,
		 };
	 se.renderInline(parentElementId, context);
 }
 </script>
 ```
The survey must be shown by using an element known as Content Division (DIV) tag, which tells the website where to place the survey on the page. The height and width of the survey can be set by using some style elements.
```html
<div id="surveyDiv" style="height: 700px; width:600px; margin-left:auto; margin-right:auto"></div>
<script> window.addEventListener('load', function () { renderSurvey("surveyDiv","Lead","Capture","Product A"); }, false); </script>
```

### Use context data from the survey responses
After you have followed the steps that are outlined in the previous module, the flow should have steps similar to the following example.

|Step|Connector|Step details|
|---|---|---|
|1|Microsoft Dataverse|When a new record is created|
|2|Microsoft Forms|Get response details|
|3|Parse JSON|Use the context data for the content and paste the context data from a test survey response as the schema|
After the preceding steps have been created, the rest of the parameters will be determined by an organization’s requirements and objectives. In the example where a survey is embedded in webpages that are related to different products, it can be used to capture and create new leads in Dynamics 365. The responses to the questions can be used to populate the **First Name**, **Last Name**, and **Email** columns, and the parameter value for the **ProductPage** variable can be used to populate the **Topic** on the **Lead**. This approach provides a Business Development manager with information to help determine which product page that the lead was on when they completed the survey.

## Create customer Power BI reports in Customer Voice
[(More)](https://learn.microsoft.com/en-us/training/modules/create-customer-power-bi-reports/)
### Use the Dynamics 365 Customer Voice Power BI template
A dashboard template is available from [GitHub](https://github.com/CustomerVoice/PowerBI/). Use the Customer Voice Dashboard.pbix file to create templates for aggregating and analyzing Dynamics 365 Customer Voice data in Power BI.
Once you've downloaded the file, you'll have a formatted empty dashboard. Get data from the Dataverse connector. Find the Dataverse location of your project from the **All project view.**

### Connect to Dynamics 365 Customer Voice data with Power BI
With Microsoft Power BI Desktop installed, it's possible to connect to all kinds of data sources. The options are continually expanded by the Microsoft Power BI team.

The following categories are available, with a wide variety of data connections within each category:
- File
- Database
- Microsoft Power Platform
- Microsoft Entra ID
- Online services
- Other

After you have signed in, select the **Get data** button, which will prompt you to select one of the data categories. Microsoft Power Platform category will be used when you are connecting to Dynamics 365 Customer Voice data. Four options are provided: Power BI datasets, Power BI dataflows, Microsoft Dataverse, and Microsoft Power Platform dataflows. Because Dynamics 365 Customer Voice data is stored in Dataverse, you should select this option.

When you are connected to the environment, the Dynamics 365 Customer Voice tables can be selected. Tables that are prefaced with **msfp** are part of Dynamics 365 Customer Voice, so all the tables can be checked from the list. Two other tables need to be selected as well: the activityparty table and the Contact table. After you have made the selection, the data will be loaded.
![[4. Surveys with Customer Voice-20240831181709206.webp]]

The following table shows which tables should be linked and through which columns.

|Link From table|Link From column|Link To table|Link To column|
|---|---|---|---|
|msfp_survey|msfp_surveyid|msfp_question|msfp_survey|
|msfp_survey|msfp_surveyid|msfp_surveyinvite|msfp_surveyid|
|msfp_survey|msfp_surveyid|msfp_surveyresponse|msfp_surveyid|
|msfp_surveyinvite|activityid|activityparty|activityid|
|activityparty|partyid|contact|contactid|
|msfp_surveyinvite|activityid|msfp_surveyresponse|msfp_surveyinviteid|
|msfp_surveyresponse|activityid|msfp_questionresponse|msfp_surveyresponseid|
|msfp_question|msfp_questionid|msfp_questionresponse|msfp_questionid|
![[4. Surveys with Customer Voice-20240831181734855.webp]]

### Create customized Power BI reports
A report can be composed of, but is not limited to, the following elements:
- Text boxes
- Buttons
- Shapes
- Images
- Charts (for example, bar, column, line, area, pie, waterfall, scatter, combo)
- Slicers
- Tables
- Matrix
- Maps
- KPIs
- Q&A visuals
[More about elements](https://learn.microsoft.com/en-us/training/modules/create-customer-power-bi-reports/4-create-reports)
### Calculate the Net Promoter Score for Customer Voice data
Based on the response that is given, a respondent is classed as one of the following types:
- **Promoter (score 9-10)** - Respondent will continue to buy from an organization, refer them, and promote them.
- **Passive (score 7-8)** - Respondent is satisfied but unenthusiastic and could be swayed by competitors.
- **Detractor (score 0-6)** - Unhappy customer who can damage an organization's brand and impede growth through negative word-of-mouth.
- 
The Net Promoter Score formula then gives you the NPS, a score that can range from a low of -100 (all Detractors) to a high of 100 (all Promoters). The formula is as follows:
	`%PROMOTERS – %DETRACTORS = NPS`

Create the column by using the following formula. This formula uses a switch statement and assigns the Detractor value for any survey response with an NPS Score of 6 or below, a Passive for any response with a 7 or an 8, and a Promoter for any response with a 9 or above.
```c
NPS Type = SWITCH(
TRUE(),
msfp_surveyresponse[msfp_npsscore<=6,"Detractors",
msfp_surveyresponse[msfp_npsscore]=7 ||
	msfp_surveyresponse[msfp_npsscore]=8,"Passives",
msfp_surveyresponse[msfp_npsscore]>=9,"Promoters")
```

Next, you will create the new measure. By using the NPS Type column that was previously created, the formula for the Total NPS will follow the NPS formula. You can divide the number of promoters by the total number of responses, do the same for the detractors, and then subtract the latter from the former. Then, multiply by 100, which will give you the whole number: the overall Net Promoter Score.
```js
TOTAL NPS = var NumOfRespon = CALCULATE(
	COUNTROWS(msfp_surveyresponse), 
	ALL(msfp_surveyresponse))
return
(CALCULATE(
	COUNTA(msfp_surveyresponse[activityid]),
	FILTER(msfp_surveyresponse, msfp_surveyresponse[NPS Type]="Promoters"))
/ NumOfRespon 
-CALCULATE(
	COUNTA(msfp_surveyresponse[activityid]),
	FILTER(msfp_surveyresponse, msfp_surveyresponse[NPS Type]="Detractors")) 
/ NumOfRespon)
-100
```

After the measure has been created, select it from the list of columns, which will provide access to the **Measure tools** tab at the top of Power BI. From the **Measure tools** tab, change the formatting of the column to a whole number so that it will display correctly. To achieve this task, set the start value of the axis to **-100** and set the end to **100**.
![[4. Surveys with Customer Voice-20240831182721202.webp|393]]
>By creating a custom column and a custom measure on the msfp_surveyresponses table, the overall Net Promoter Score can be created for all responses within the selected data source. Consider also filtering the data to only include those responses that include an NPS score or filtering the surveys to only include specific ones by name. Using this process provides the knowledge that is needed to add the NPS score to other reports or dashboards or add more filtering to help find the NPS for a specific business unit, industry, or an individual account record.

